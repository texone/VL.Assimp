name: Publish VL.Assimp NuGet

on:
  # Run automatically when you push to master (optional)
  push:
    branches: [ master ]
    paths-ignore:
      - README.md

  # âœ… Allow manual trigger from GitHub UI
  workflow_dispatch:
    inputs:
      version:
        description: 'Version number (e.g. 0.0.6-alpha)'
        required: false
        default: ''
      publish:
        description: 'Publish to NuGet.org? (true/false)'
        required: false
        default: 'true'

jobs:
  build-and-publish:
    runs-on: windows-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup MSBuild
        uses: microsoft/setup-msbuild@v2

      - name: Setup NuGet
        uses: nuget/setup-nuget@v2

      - name: Publish VL NuGet
        uses: vvvv/PublishVLNuget@1.0.43
        with:
          # Your project to build
          csproj: src\VL.Assimp\VL.Assimp.csproj
          # Your nuspec to package/publish
          nuspec: deployment\VL.Assimp.nuspec
          # Optional icon
          icon-src: https://raw.githubusercontent.com/vvvv/PublicContent/master/nugeticon.png
          icon-dst: ./deployment/nugeticon.png
          # NuGet.org API key stored in repo secrets
          nuget-key: ${{ secrets.NUGET_KEY }}
          # Optional: set version dynamically if given in manual run
          version: ${{ github.event.inputs.version }}
          # Optional: skip publish when testing manually
          publish: ${{ github.event.inputs.publish }}
